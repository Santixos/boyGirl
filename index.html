<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>


    <!--
It's a new edition of MyLittle team exercise that uses Objects
TODO:
1. Button "add" must add a new row to the "My little Team" list, with chosen name and sex. Check document.createElement function documentation


2. AT THE BEGINNING the list of children must correspond the structure that is saved in const childrenList (see lines 93-114): this constant represents an array of Objects, where every object corresponds a child and has all the necessary information of this child (name, sex, date of birth). You are going to use only name and sex in this exercise.


So at the beginning (when opening the page) My Little Team list must consist of these 4 children
-->
    <div class="rounded-box">
        <h2>Add a kid</h2>
        <input id="nameInput" placeholder="enter name" />
        <select id="Sex">
            <option value="m">Boy</option>
            <option value="f">Girl</option>
        </select>
        <button>add</button>
    </div>


    <div class="rounded-box">
        <h2>My little Team</h2>
        <div id="kids-list">
            <div class="item male">
                <div class="name">Peter Pan</div>
                <button onclick="deleteItem(this)">remove</button>
            </div>
            <div class="item female">
                <div class="name">Mary Poppins</div>
                <button onclick="deleteItem(this)">remove</button>
            </div>
        </div>
    </div>


    <style>
        .item {
            display: flex;
            justify-content: space-between;
            padding: 0.25em;
            padding-left: 2em;
            margin: 0.25em 0;
            position: relative;
        }


        .item::before {
            position: absolute;
            left: 0.5em;
            font-weight: bold;
        }


        .male {
            background: lightblue;
        }


        .male::before {
            content: '♂️';
        }


        .female {
            background: salmon;
        }


        .female::before {
            content: '♀';
        }


        .name {
            width: 30%;
        }


        /* page styling */
        body {
            background: url(https://media.istockphoto.com/id/509175470/de/vektor/hintergrund-f%C3%BCr-kleine-jungen-handgezeichnet-kinder-zeichnungen.jpg?s=612x612&w=0&k=20&c=xRRpevgrUH70gPHo4SQHRPOrl7HFz91VeG0svxFJtu4=);
            background-size: 300px;
            color: var(--our-blue);
            --our-blue: #186b89;
        }


        h2 {
            font-family: "Comics Sans";
        }


        .rounded-box {
            background: white;
            padding: 0.5em;
            border-radius: 0.5em;
            border: 4px solid var(--our-blue);
            margin-bottom: 1em;
        }
    </style>


    <script>


        const birthDateInput = document.createElement("input");
        birthDateInput.type = "date";
        const inputContainer = document.createElement("div");
        document.getElementsByClassName("rounded-box")[0].append(inputContainer);
        
        inputContainer.append(birthDateInput);
        inputContainer.append(document.getElementById("nameInput"));
      

       
        document.getElementsByClassName("rounded-box")[0].append(birthDateInput);

        const childrenList = [
            {
                name: 'Adam Sendler',
                sex: 'm',
                dateOfBirth: '2013-01-17'
            },
            {
                name: 'Eva Braun',
                sex: 'f',
                dateOfBirth: '2018-08-07'
            },
            {
                name: 'Rocky Balboa',
                sex: 'm',
                dateOfBirth: '2011-10-03'
            },
            {
                name: 'Linda Evangelista',
                sex: 'f',
                dateOfBirth: '2019-03-08'
            }
        ];
        // calcolare eta'
        function calcolaEta(dataNascita) {
            const dataNascitaObj = new Date(dataNascita);
            const dataCorrente = new Date();


            let anni = dataCorrente.getFullYear() - dataNascitaObj.getFullYear();
            const mesi = dataCorrente.getMonth() - dataNascitaObj.getMonth();


            // Verifica se il compleanno del mese corrente è già avvenuto o no
            if (mesi < 0 || (mesi === 0 && dataCorrente.getDate() < dataNascitaObj.getDate())) {
                anni--;
            }


            return anni;
        }






        function addRow(name, sex, age) {


            let ageVisualized;
            if (age) { ageVisualized = age; }
            else { ageVisualized = "-"; }


            /* (age) Se age equivale a true (i casi in cui (age) dà true sono tutti trane 0, null, undefined, false, "", NaN)
            
            
            (!age) Se age è uguale a false ( cioè (!age) dà come risultato  true quando è uguale a uno dei seguenti casi:
            0, null, undefined, false, "", NaN)
            
            
            Altrimenti darà false*/



            const newRow = document.createElement("div");
            newRow.classList.add("item");
            let sexClassName;

            /* sostituire if con tre*/


            if (sex === "m") {
                sexClassName = "male";
            } else {
                sexClassName = "female";
            }


            newRow.classList.add(sexClassName);


            document.getElementById("kids-list").append(newRow);

            const nameContainer = document.createElement("div");
            nameContainer.classList.add("name");
            newRow.append(nameContainer);
            nameContainer.innerText = name;
            const ageContainer = document.createElement("div");
            newRow.append(ageContainer);
            ageContainer.innerText = ageVisualized;
            const insertButton = document.createElement("button");
            newRow.append(insertButton);
            insertButton.innerText = "kick the kid out!";
            insertButton.onclick = function () {
                deleteItem(nameContainer);
            }


        }


        document.getElementById("kids-list").innerHTML = "";


        const vips = childrenList.length;
        for (let i = 0; i < vips; i++) {

            addRow(childrenList[i].name, childrenList[i].sex, calcolaEta(childrenList[i].dateOfBirth));


        }


        document.getElementsByTagName("button")[0].onclick = function () {

            addRow(
                document.getElementById("nameInput").value, 
                document.getElementById("Sex").value, 
                calcolaEta(birthDateInput.value)
            );

        }
        function deleteItem(caller) {
            console.log(caller);
            caller.parentNode.remove();
        }




    </script>

</body>

</html>